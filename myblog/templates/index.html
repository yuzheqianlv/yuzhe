{% extends "base.html" %}

{% block content %}
<div class="page-content home-content">
    <div class="welcome-section">
        <h1 class="welcome-title typewriter"></h1>
        <div class="welcome-text">
            <div class="intro-text typewriter"></div>
            
            <div class="feature-list">
                <div class="feature-item">
                    <div class="feature-header">
                        <span class="feature-icon">📝</span>
                        <h3 class="typewriter"></h3>
                    </div>
                    <p class="typewriter"></p>
                </div>
                <div class="feature-item">
                    <div class="feature-header">
                        <span class="feature-icon">🔧</span>
                        <h3 class="typewriter"></h3>
                    </div>
                    <p class="typewriter"></p>
                </div>
                <div class="feature-item">
                    <div class="feature-header">
                        <span class="feature-icon">📚</span>
                        <h3 class="typewriter"></h3>
                    </div>
                    <p class="typewriter"></p>
                </div>
                <div class="feature-item">
                    <div class="feature-header">
                        <span class="feature-icon">🎨</span>
                        <h3 class="typewriter"></h3>
                    </div>
                    <p class="typewriter"></p>
                </div>
            </div>

            <div class="blog-description">
                <p class="typewriter"></p>
                <p class="typewriter"></p>
            </div>

            <div class="blog-features">
                <h2 class="typewriter"></h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <span class="feature-icon">⚡</span>
                        <h3 class="typewriter"></h3>
                        <p class="typewriter"></p>
                    </div>
                    <div class="feature-card">
                        <span class="feature-icon">🔍</span>
                        <h3 class="typewriter"></h3>
                        <p class="typewriter"></p>
                    </div>
                    <div class="feature-card">
                        <span class="feature-icon">📱</span>
                        <h3 class="typewriter"></h3>
                        <p class="typewriter"></p>
                    </div>
                    <div class="feature-card">
                        <span class="feature-icon">🎨</span>
                        <h3 class="typewriter"></h3>
                        <p class="typewriter"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* 基础样式 */
.page-content {
    max-width: 1000px;
    margin: 0 auto;
    padding: 2rem;
}

/* 文字动画基础样式 */
.typewriter {
    opacity: 0;
    transform: translateY(10px);
    will-change: opacity, transform;
    transition: opacity 0.3s ease, transform 0.3s ease;
}

.typewriter.typing {
    opacity: 1;
    transform: translateY(0);
}

.typewriter.completed {
    opacity: 1;
    transform: none;
}

/* 标题样式 */
.welcome-title {
    font-size: 2.5rem;
    color: var(--title-color);
    text-align: center;
    margin-bottom: 3rem;
}

/* 介绍文字样式 */
.intro-text {
    font-size: 1.2rem;
    color: var(--text-color);
    text-align: center;
    margin-bottom: 2rem;
}

/* 特性列表样式 */
.feature-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin: 2rem 0;
}

.feature-item {
    padding: 1.5rem;
    background: var(--bg-color);
    border-radius: 8px;
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
}

.feature-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
}

.feature-icon {
    font-size: 1.5rem;
}

.feature-item h3 {
    margin: 0;
    color: var(--title-color);
}

.feature-item p {
    margin: 0;
    color: var(--text-color);
    line-height: 1.6;
}

/* 博客描述样式 */
.blog-description {
    margin: 3rem 0;
    padding: 2rem;
    background: rgba(66, 185, 131, 0.1);
    border-radius: 8px;
    border-left: 4px solid var(--primary-color);
}

.blog-description p {
    margin: 0.5rem 0;
    line-height: 1.8;
}

/* 博客特点样式 */
.blog-features h2 {
    text-align: center;
    margin-bottom: 2rem;
}

.features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
}

.feature-card {
    padding: 1.5rem;
    text-align: center;
    background: var(--bg-color);
    border-radius: 8px;
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
}

/* 动画延迟 */
.welcome-title.animate { animation-delay: 0.2s; }
.intro-text.animate { animation-delay: 0.4s; }
.feature-item:nth-child(1).animate { animation-delay: 0.5s; }
.feature-item:nth-child(2).animate { animation-delay: 0.6s; }
.feature-item:nth-child(3).animate { animation-delay: 0.7s; }
.feature-item:nth-child(4).animate { animation-delay: 0.8s; }
.blog-description.animate { animation-delay: 0.9s; }
.blog-features h2.animate { animation-delay: 1s; }
.feature-card:nth-child(1).animate { animation-delay: 1.1s; }
.feature-card:nth-child(2).animate { animation-delay: 1.2s; }
.feature-card:nth-child(3).animate { animation-delay: 1.3s; }
.feature-card:nth-child(4).animate { animation-delay: 1.4s; }

/* 悬停效果 */
.feature-item:hover,
.feature-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px var(--shadow-color);
}

/* 响应式调整 */
@media (max-width: 768px) {
    .page-content {
        padding: 1rem;
    }
    
    .welcome-title {
        font-size: 2rem;
    }
    
    .feature-list,
    .features-grid {
        grid-template-columns: 1fr;
    }
}

/* 打字机效果相关样式 */
.typewriter {
    position: relative;
    white-space: pre-wrap;
    overflow: hidden;
}

.typewriter::after {
    content: '';
    position: absolute;
    right: 0;
    top: 0;
    height: 100%;
    width: 2px;
    background: var(--primary-color);
    opacity: 0;
    transform: translateX(2px);
    transition: opacity 0.3s ease;
}

.typewriter.typing::after {
    opacity: 1;
    animation: cursor-blink 0.7s steps(2) infinite;
}

@keyframes cursor-blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
}
</style>

<script>
// 修改打字机效果实现
class Typewriter {
    constructor(element, text, options = {}) {
        this.element = element;
        this.text = text;
        this.delay = options.delay || 50;
        this.startDelay = options.startDelay || 0;
        this.onComplete = options.onComplete;
        this.currentChar = 0;
        this._frame = null;
    }

    start() {
        this.element.classList.add('typing');
        this._scheduleNextFrame(this.startDelay);
    }

    _scheduleNextFrame(delay) {
        this._frame = requestAnimationFrame(() => {
            setTimeout(() => this.type(), delay);
        });
    }

    type() {
        if (this.currentChar < this.text.length) {
            this.element.textContent = this.text.slice(0, ++this.currentChar);
            this._scheduleNextFrame(this.delay);
        } else {
            this.element.classList.remove('typing');
            this.element.classList.add('completed');
            cancelAnimationFrame(this._frame);
            if (this.onComplete) {
                this.onComplete();
            }
        }
    }
}

// 初始化所有文字内容
document.addEventListener('DOMContentLoaded', () => {
    const contents = {
        '.welcome-title': {
            text: '欢迎来到千虑者的博客',
            delay: 30
        },
        '.intro-text': {
            text: '这是一个专注于技术分享和学习记录的个人博客。主要关注：',
            delay: 20,
            startDelay: 300
        },
        '.feature-item:nth-child(1) h3': {
            text: '技术探索',
            startDelay: 600
        },
        '.feature-item:nth-child(1) p': {
            text: '深入研究 Rust、WebAssembly、系统编程等领域的技术实践',
            startDelay: 800
        },
        '.feature-item:nth-child(2) h3': {
            text: '工程实践',
            startDelay: 1000
        },
        '.feature-item:nth-child(2) p': {
            text: '分享软件开发中的最佳实践、架构设计和性能优化经验',
            startDelay: 1200
        },
        '.feature-item:nth-child(3) h3': {
            text: '学习笔记',
            startDelay: 1400
        },
        '.feature-item:nth-child(3) p': {
            text: '记录技术书籍阅读心得和学习过程中的思考总结',
            startDelay: 1600
        },
        '.feature-item:nth-child(4) h3': {
            text: '项目实战',
            startDelay: 1800
        },
        '.feature-item:nth-child(4) p': {
            text: '展示个人开源项目和有趣的技术实验',
            startDelay: 2000
        },
        '.blog-description p:nth-child(1)': {
            text: '博客名「千虑者」源于"智者千虑必有一失，愚者千虑必有一得"，寓意在技术探索的道路上保持开放和谦逊的心态。',
            startDelay: 3000
        },
        '.blog-description p:nth-child(2)': {
            text: '通过写作和分享，记录技术成长的点滴，也希望能为开发者社区贡献一份力量。',
            startDelay: 3500
        },
        '.blog-features h2': {
            text: '博客特点',
            startDelay: 3500
        },
        '.blog-features .feature-card:nth-child(1) h3': {
            text: '高性能',
            startDelay: 3200
        },
        '.blog-features .feature-card:nth-child(1) p': {
            text: '基于 Zola 静态站点生成器，快速加载，极致体验',
            startDelay: 3400
        },
        '.blog-features .feature-card:nth-child(2) h3': {
            text: '全文搜索',
            startDelay: 3600
        },
        '.blog-features .feature-card:nth-child(2) p': {
            text: '基于 Rust 实现的高性能全文搜索功能',
            startDelay: 3800
        },
        '.blog-features .feature-card:nth-child(3) h3': {
            text: '响应式设计',
            startDelay: 3000
        },
        '.blog-features .feature-card:nth-child(3) p': {
            text: '完美适配各种设备，提供最佳阅读体验',
            startDelay: 3200
        },
        '.blog-features .feature-card:nth-child(4) h3': {
            text: '优雅排版',
            startDelay: 3400
        },
        '.blog-features .feature-card:nth-child(4) p': {
            text: '精心设计的版式和配色，让阅读更加舒适',
            startDelay: 3600
        }
    };

    // 创建 Intersection Observer
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const element = entry.target;
                const config = contents[getSelector(element)];
                if (config) {
                    new Typewriter(element, config.text, {
                        delay: config.delay,
                        startDelay: config.startDelay,
                        cursor: config.cursor,
                        onComplete: config.onComplete
                    }).start();
                }
                observer.unobserve(element);
            }
        });
    }, {
        threshold: 0.1,
        rootMargin: '50px'
    });

    // 获取元素的选择器
    function getSelector(element) {
        for (let selector in contents) {
            if (element.matches(selector)) {
                return selector;
            }
        }
    }

    // 观察所有打字机元素
    document.querySelectorAll('.typewriter').forEach(element => {
        observer.observe(element);
    });
});
</script>
{% endblock content %}