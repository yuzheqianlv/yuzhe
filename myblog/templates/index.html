{% extends "base.html" %}

{% block content %}
<div class="page-content home-content">
    <div class="welcome-section">
        <h1 class="welcome-title typewriter"></h1>
        <div class="welcome-text">
            <div class="intro-text typewriter"></div>
            
            <div class="feature-list">
                <div class="feature-item">
                    <div class="feature-header">
                        <span class="feature-icon">ğŸ“</span>
                        <h3 class="typewriter"></h3>
                    </div>
                    <p class="typewriter"></p>
                </div>
                <div class="feature-item">
                    <div class="feature-header">
                        <span class="feature-icon">ğŸ”§</span>
                        <h3 class="typewriter"></h3>
                    </div>
                    <p class="typewriter"></p>
                </div>
                <div class="feature-item">
                    <div class="feature-header">
                        <span class="feature-icon">ğŸ“š</span>
                        <h3 class="typewriter"></h3>
                    </div>
                    <p class="typewriter"></p>
                </div>
                <div class="feature-item">
                    <div class="feature-header">
                        <span class="feature-icon">ğŸ¨</span>
                        <h3 class="typewriter"></h3>
                    </div>
                    <p class="typewriter"></p>
                </div>
            </div>

            <div class="blog-description">
                <p class="typewriter"></p>
                <p class="typewriter"></p>
            </div>

            <div class="blog-features">
                <h2 class="typewriter"></h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <span class="feature-icon">âš¡</span>
                        <h3 class="typewriter"></h3>
                        <p class="typewriter"></p>
                    </div>
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ”</span>
                        <h3 class="typewriter"></h3>
                        <p class="typewriter"></p>
                    </div>
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ“±</span>
                        <h3 class="typewriter"></h3>
                        <p class="typewriter"></p>
                    </div>
                    <div class="feature-card">
                        <span class="feature-icon">ğŸ¨</span>
                        <h3 class="typewriter"></h3>
                        <p class="typewriter"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* åŸºç¡€æ ·å¼ */
.page-content {
    max-width: 1000px;
    margin: 0 auto;
    padding: 2rem;
}

/* æ–‡å­—åŠ¨ç”»åŸºç¡€æ ·å¼ */
.typewriter {
    opacity: 0;
    transform: translateY(10px);
    will-change: opacity, transform;
    transition: opacity 0.3s ease, transform 0.3s ease;
}

.typewriter.typing {
    opacity: 1;
    transform: translateY(0);
}

.typewriter.completed {
    opacity: 1;
    transform: none;
}

/* æ ‡é¢˜æ ·å¼ */
.welcome-title {
    font-size: 2.5rem;
    color: var(--title-color);
    text-align: center;
    margin-bottom: 3rem;
}

/* ä»‹ç»æ–‡å­—æ ·å¼ */
.intro-text {
    font-size: 1.2rem;
    color: var(--text-color);
    text-align: center;
    margin-bottom: 2rem;
}

/* ç‰¹æ€§åˆ—è¡¨æ ·å¼ */
.feature-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin: 2rem 0;
}

.feature-item {
    padding: 1.5rem;
    background: var(--bg-color);
    border-radius: 8px;
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
}

.feature-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
}

.feature-icon {
    font-size: 1.5rem;
}

.feature-item h3 {
    margin: 0;
    color: var(--title-color);
}

.feature-item p {
    margin: 0;
    color: var(--text-color);
    line-height: 1.6;
}

/* åšå®¢æè¿°æ ·å¼ */
.blog-description {
    margin: 3rem 0;
    padding: 2rem;
    background: rgba(66, 185, 131, 0.1);
    border-radius: 8px;
    border-left: 4px solid var(--primary-color);
}

.blog-description p {
    margin: 0.5rem 0;
    line-height: 1.8;
}

/* åšå®¢ç‰¹ç‚¹æ ·å¼ */
.blog-features h2 {
    text-align: center;
    margin-bottom: 2rem;
}

.features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
}

.feature-card {
    padding: 1.5rem;
    text-align: center;
    background: var(--bg-color);
    border-radius: 8px;
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
}

/* åŠ¨ç”»å»¶è¿Ÿ */
.welcome-title.animate { animation-delay: 0.2s; }
.intro-text.animate { animation-delay: 0.4s; }
.feature-item:nth-child(1).animate { animation-delay: 0.5s; }
.feature-item:nth-child(2).animate { animation-delay: 0.6s; }
.feature-item:nth-child(3).animate { animation-delay: 0.7s; }
.feature-item:nth-child(4).animate { animation-delay: 0.8s; }
.blog-description.animate { animation-delay: 0.9s; }
.blog-features h2.animate { animation-delay: 1s; }
.feature-card:nth-child(1).animate { animation-delay: 1.1s; }
.feature-card:nth-child(2).animate { animation-delay: 1.2s; }
.feature-card:nth-child(3).animate { animation-delay: 1.3s; }
.feature-card:nth-child(4).animate { animation-delay: 1.4s; }

/* æ‚¬åœæ•ˆæœ */
.feature-item:hover,
.feature-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px var(--shadow-color);
}

/* å“åº”å¼è°ƒæ•´ */
@media (max-width: 768px) {
    .page-content {
        padding: 1rem;
    }
    
    .welcome-title {
        font-size: 2rem;
    }
    
    .feature-list,
    .features-grid {
        grid-template-columns: 1fr;
    }
}

/* æ‰“å­—æœºæ•ˆæœç›¸å…³æ ·å¼ */
.typewriter {
    position: relative;
    white-space: pre-wrap;
    overflow: hidden;
}

.typewriter::after {
    content: '';
    position: absolute;
    right: 0;
    top: 0;
    height: 100%;
    width: 2px;
    background: var(--primary-color);
    opacity: 0;
    transform: translateX(2px);
    transition: opacity 0.3s ease;
}

.typewriter.typing::after {
    opacity: 1;
    animation: cursor-blink 0.7s steps(2) infinite;
}

@keyframes cursor-blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
}
</style>

<script>
// ä¿®æ”¹æ‰“å­—æœºæ•ˆæœå®ç°
class Typewriter {
    constructor(element, text, options = {}) {
        this.element = element;
        this.text = text;
        this.delay = options.delay || 50;
        this.startDelay = options.startDelay || 0;
        this.onComplete = options.onComplete;
        this.currentChar = 0;
        this._frame = null;
    }

    start() {
        this.element.classList.add('typing');
        this._scheduleNextFrame(this.startDelay);
    }

    _scheduleNextFrame(delay) {
        this._frame = requestAnimationFrame(() => {
            setTimeout(() => this.type(), delay);
        });
    }

    type() {
        if (this.currentChar < this.text.length) {
            this.element.textContent = this.text.slice(0, ++this.currentChar);
            this._scheduleNextFrame(this.delay);
        } else {
            this.element.classList.remove('typing');
            this.element.classList.add('completed');
            cancelAnimationFrame(this._frame);
            if (this.onComplete) {
                this.onComplete();
            }
        }
    }
}

// åˆå§‹åŒ–æ‰€æœ‰æ–‡å­—å†…å®¹
document.addEventListener('DOMContentLoaded', () => {
    const contents = {
        '.welcome-title': {
            text: 'æ¬¢è¿æ¥åˆ°åƒè™‘è€…çš„åšå®¢',
            delay: 30
        },
        '.intro-text': {
            text: 'è¿™æ˜¯ä¸€ä¸ªä¸“æ³¨äºæŠ€æœ¯åˆ†äº«å’Œå­¦ä¹ è®°å½•çš„ä¸ªäººåšå®¢ã€‚ä¸»è¦å…³æ³¨ï¼š',
            delay: 20,
            startDelay: 300
        },
        '.feature-item:nth-child(1) h3': {
            text: 'æŠ€æœ¯æ¢ç´¢',
            startDelay: 600
        },
        '.feature-item:nth-child(1) p': {
            text: 'æ·±å…¥ç ”ç©¶ Rustã€WebAssemblyã€ç³»ç»Ÿç¼–ç¨‹ç­‰é¢†åŸŸçš„æŠ€æœ¯å®è·µ',
            startDelay: 800
        },
        '.feature-item:nth-child(2) h3': {
            text: 'å·¥ç¨‹å®è·µ',
            startDelay: 1000
        },
        '.feature-item:nth-child(2) p': {
            text: 'åˆ†äº«è½¯ä»¶å¼€å‘ä¸­çš„æœ€ä½³å®è·µã€æ¶æ„è®¾è®¡å’Œæ€§èƒ½ä¼˜åŒ–ç»éªŒ',
            startDelay: 1200
        },
        '.feature-item:nth-child(3) h3': {
            text: 'å­¦ä¹ ç¬”è®°',
            startDelay: 1400
        },
        '.feature-item:nth-child(3) p': {
            text: 'è®°å½•æŠ€æœ¯ä¹¦ç±é˜…è¯»å¿ƒå¾—å’Œå­¦ä¹ è¿‡ç¨‹ä¸­çš„æ€è€ƒæ€»ç»“',
            startDelay: 1600
        },
        '.feature-item:nth-child(4) h3': {
            text: 'é¡¹ç›®å®æˆ˜',
            startDelay: 1800
        },
        '.feature-item:nth-child(4) p': {
            text: 'å±•ç¤ºä¸ªäººå¼€æºé¡¹ç›®å’Œæœ‰è¶£çš„æŠ€æœ¯å®éªŒ',
            startDelay: 2000
        },
        '.blog-description p:nth-child(1)': {
            text: 'åšå®¢åã€Œåƒè™‘è€…ã€æºäº"æ™ºè€…åƒè™‘å¿…æœ‰ä¸€å¤±ï¼Œæ„šè€…åƒè™‘å¿…æœ‰ä¸€å¾—"ï¼Œå¯“æ„åœ¨æŠ€æœ¯æ¢ç´¢çš„é“è·¯ä¸Šä¿æŒå¼€æ”¾å’Œè°¦é€Šçš„å¿ƒæ€ã€‚',
            startDelay: 3000
        },
        '.blog-description p:nth-child(2)': {
            text: 'é€šè¿‡å†™ä½œå’Œåˆ†äº«ï¼Œè®°å½•æŠ€æœ¯æˆé•¿çš„ç‚¹æ»´ï¼Œä¹Ÿå¸Œæœ›èƒ½ä¸ºå¼€å‘è€…ç¤¾åŒºè´¡çŒ®ä¸€ä»½åŠ›é‡ã€‚',
            startDelay: 3500
        },
        '.blog-features h2': {
            text: 'åšå®¢ç‰¹ç‚¹',
            startDelay: 3500
        },
        '.blog-features .feature-card:nth-child(1) h3': {
            text: 'é«˜æ€§èƒ½',
            startDelay: 3200
        },
        '.blog-features .feature-card:nth-child(1) p': {
            text: 'åŸºäº Zola é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ï¼Œå¿«é€ŸåŠ è½½ï¼Œæè‡´ä½“éªŒ',
            startDelay: 3400
        },
        '.blog-features .feature-card:nth-child(2) h3': {
            text: 'å…¨æ–‡æœç´¢',
            startDelay: 3600
        },
        '.blog-features .feature-card:nth-child(2) p': {
            text: 'åŸºäº Rust å®ç°çš„é«˜æ€§èƒ½å…¨æ–‡æœç´¢åŠŸèƒ½',
            startDelay: 3800
        },
        '.blog-features .feature-card:nth-child(3) h3': {
            text: 'å“åº”å¼è®¾è®¡',
            startDelay: 3000
        },
        '.blog-features .feature-card:nth-child(3) p': {
            text: 'å®Œç¾é€‚é…å„ç§è®¾å¤‡ï¼Œæä¾›æœ€ä½³é˜…è¯»ä½“éªŒ',
            startDelay: 3200
        },
        '.blog-features .feature-card:nth-child(4) h3': {
            text: 'ä¼˜é›…æ’ç‰ˆ',
            startDelay: 3400
        },
        '.blog-features .feature-card:nth-child(4) p': {
            text: 'ç²¾å¿ƒè®¾è®¡çš„ç‰ˆå¼å’Œé…è‰²ï¼Œè®©é˜…è¯»æ›´åŠ èˆ’é€‚',
            startDelay: 3600
        }
    };

    // åˆ›å»º Intersection Observer
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const element = entry.target;
                const config = contents[getSelector(element)];
                if (config) {
                    new Typewriter(element, config.text, {
                        delay: config.delay,
                        startDelay: config.startDelay,
                        cursor: config.cursor,
                        onComplete: config.onComplete
                    }).start();
                }
                observer.unobserve(element);
            }
        });
    }, {
        threshold: 0.1,
        rootMargin: '50px'
    });

    // è·å–å…ƒç´ çš„é€‰æ‹©å™¨
    function getSelector(element) {
        for (let selector in contents) {
            if (element.matches(selector)) {
                return selector;
            }
        }
    }

    // è§‚å¯Ÿæ‰€æœ‰æ‰“å­—æœºå…ƒç´ 
    document.querySelectorAll('.typewriter').forEach(element => {
        observer.observe(element);
    });
});
</script>
{% endblock content %}